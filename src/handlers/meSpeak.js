/**
 * Minified by jsDelivr using UglifyJS v3.3.20.
 * Original file: /npm/mespeak@2.0.2/src/index.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";var HttpRequest,ESpeak=require("./ESpeak.js"),eSpeakDir="/espeak",eSpeakDataDir="/espeak/espeak-data",eSpeakVoicesDir="/espeak/espeak-data/voices",eSpeak=new ESpeak,fileRegistry=[],fsErrorDetected=!1,configDataLoaded=!1,unloading=!1,speakQueue=[],voicesLoaded={},defaultVoice="",AudioAPI=null,canPlay=!1,playbackVolume=1,masterGain=null,audioContext=null,audioPool={},webSoundPool={},isChrome="undefined"!=typeof navigator&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("Chrome"),chromeVersion=isChrome?parseInt(navigator.userAgent.replace(/^.*?\bChrome\/([0-9]+).*$/,"$1"),10):0;function fsCreateDataFile(e,n,a,t){eSpeak.FS.findObject(e)||eSpeak.FS.createPath("/",e.substring(1),!0,!0),eSpeak.FS.createDataFile(e,n,a,!0,!1),t||fileRegistry.push({path:e,fname:n})}function recoverFromFSError(e){console.log("meSpeak -- recovering from error:",e);var n,a,t=[],o=fileRegistry.length;for(a=0;a<o;a++)n=fileRegistry[a],t.push(eSpeak.FS.findObject(n.path+"/"+n.fname).contents);for(eSpeak=new ESpeak,setUpVFS(),a=0;a<o;a++)fsCreateDataFile((n=fileRegistry[a]).path,n.fname,t[a],!0);fsErrorDetected=!0}function setUpVFS(){var e={croak:"language variant\nname croak\ngender male 70\npitch 85 117\nflutter 20\nformant 0 100 80 110\n",f1:"language variant\nname female1\ngender female 70\npitch 140 200\nflutter 8\nroughness 4\nformant 0 115 80 150\nformant 1 120 80 180\nformant 2 100 70 150 150\nformant 3 115 70 150\nformant 4 110 80 150\nformant 5 110 90 150\nformant 6 105 80 150\nformant 7 110 70 150\nformant 8 110 70 150\nstressAdd -10 -10 -20 -20 0 0 40 60\n",f2:"language variant\nname female2\ngender female\npitch 142 220\nroughness 3\nformant 0 105 80 150\nformant 1 110 80 160\nformant 2 110 70 150\nformant 3 110 70 150\nformant 4 115 80 150\nformant 5 115 80 150\nformant 6 110 70 150\nformant 7 110 70 150\nformant 8 110 70 150\nstressAdd 0 0 -10 -10 0 0 10 40\nbreath 0 2 3 3 3 3 3 2\necho 140 10\nconsonants 125 125\n",f3:"language variant\nname female3\ngender female\npitch 140 240\nformant 0 105 80 150\nformant 1 120 75 150 -50\nformant 2 135 70 150 -250\nformant 3 125 80 150\nformant 4 125 80 150\nformant 5 125 80 150\nformant 6 120 70 150\nformant 7 110 70 150\nformant 8 110 70 150\nstressAmp 18 18 20 20 20 20 20 20\n//breath 0 2 4 4 4 4 4 4\nbreath 0 2 3 3 3 3 3 2\necho 120 10\nroughness 4\n",f4:"language variant\nname female4\ngender female\necho 130 15\npitch 142 200\nformant 0 120 80 150\nformant 1 115 80 160 -20\nformant 2 130 75 150 -200\nformant 3 123 75 150\nformant 4 125 80 150\nformant 5 125 80 150\nformant 6 110 80 150\nformant 7 110 75 150\nformant 8 110 75 150\nstressAdd -20 -20 -20 -20 0 0 20 120\nstressAmp 18 16 20 20 20 20 20 20\n",f5:"language variant\nname female5\ngender female\npitch 160 228\nroughness 0\nformant 0 105 80 150\nformant 1 110 80 160\nformant 2 110 70 150\nformant 3 110 70 150\nformant 4 115 80 200\nformant 5 115 80 100\nformant 6 110 70 150\nformant 7 110 70 100\nformant 8 110 70 150\nstressAdd 0 0 -10 -10 0 0 10 40\nbreath 0 4 6   6 6   6 0 10\necho 140 10\nvoicing 75\nconsonants 150 150\nbreathw 150 150 200 200 400 400\n",klatt:"language variant\nname klatt\nklatt 1\n",klatt2:"language variant\nname klatt2\nklatt 2\n",klatt3:"language variant\nname klatt3\nklatt 3\n",m1:"language variant\nname male1\ngender male 70\npitch 75 109\nflutter 5\nroughness 4\nconsonants 80 100\nformant 0 98 100 100\nformant 1 97 100 100\nformant 2 97 95 100\nformant 3 97 95 100\nformant 4 97 85 100\nformant 5 105 80 100\nformant 6 95 80 100\nformant 7 100 100 100\nformant 8 100 100 100\n//stressAdd -10 -10 -20 -20 0 0 40 70\n",m2:"language variant\nname male2\ngender male\npitch 88 115\necho 130 15\nformant 0 100 80 120\nformant 1 90 85 120\nformant 2 110 85 120\nformant 3 105 90 120\nformant 4 100 90 120\nformant 5 100 90 120\nformant 6 100 90 120\nformant 7 100 90 120\nformant 8 100 90 120\n",m3:"language variant\nname male3\ngender male\npitch 80 122\nformant 0 100 100 100\nformant 1 96 97 100\nformant 2 96 97 100\nformant 3 96 103 100\nformant 4 95 103 100\nformant 5 95 103 100\nformant 6 100 100 100\nformant 7 100 100 100\nformant 8 100 100 100\nstressAdd 10 10 0 0 0 0 -30 -30\n",m4:"language variant\nname male4\ngender male\npitch 70 110\nformant 0 103 100 100\nformant 1 103 100 100\nformant 2 103 100 100\nformant 3 103 100 100\nformant 4 106 100 100\nformant 5 106 100 100\nformant 6 106 100 100\nformant 7 103 100 100\nformant 8 103 100 100\nstressAdd -10 -10 -30 -30 0 0 60 90\n",m5:"language variant\nname male5\ngender male\nformant 0 100 85 130\nformant 1 90 85 130 40\nformant 2 80 85 130 310\nformant 3 105 85 130\nformant 4 105 85 130\nformant 5 105 85 130\nformant 6 105 85 150\nformant 7 105 85 150\nformant 8 105 85 150\nintonation 2\n",m6:"language variant\nname male6\ngender male\npitch 82 117\nformant 0 100 90 120\nformant 1 100 90 140\nformant 2 100 70 140\nformant 3 100 75 140\nformant 4 100 80 140\nformant 5 100 80 140\n",m7:"language variant\nname male7\npitch 75 125\nformant 0 100 125 100\nformant 1 100 90 80\nformant 2 100 70 90\nformant 3 100 60 90\nformant 4 100 60 90\nformant 5 75 50 90\nformant 6 90 50 100\nformant 7 100 50 100\nformant 8 100 50 100\nvoicing 155\n",whisper:"language variant\nname whisper\npitch 75 125\nformant 0 100 125 100\nformant 1 100 90 80\nformant 2 100 70 90\nformant 3 100 60 90\nformant 4 100 60 90\nformant 5 75 50 90\nformant 6 90 50 100\nformant 7 100 50 100\nformant 8 100 50 100\nvoicing 155\n",whisperf:"language variant\nname female whisper\ngender female\npitch 160 220\nroughness 3\nformant 0 105 0 150\nformant 1 110 40 160\nformant 2 110 70 150\nformant 3 110 70 150\nformant 4 115 80 150\nformant 5 115 80 150\nformant 6 110 70 150\nformant 7 110 70 150\nformant 8 110 70 150\nstressAdd 0 0 -10 -10 0 0 10 40\n// whisper\nvoicing 20\nbreath 75 75 50 40 15 10\nbreathw 150 150 200 200 400 400\n"},n=eSpeakVoicesDir+"/!v";for(var a in eSpeak.FS.createPath("/",n.substring(1),!0,!0),eSpeak.FS.root.write=!0,e)eSpeak.FS.createDataFile(n,a,decodeStringToArray(e[a]),!0,!0)}function setConfigData(e){[["config",decodeBase64ToArray(e.config)],["phontab",decodeBase64ToArray(e.phontab)],["phonindex",decodeBase64ToArray(e.phonindex)],["phondata",decodeBase64ToArray(e.phondata)],["intonations",decodeBase64ToArray(e.intonations)]].forEach(function(e){var n=e[0],a=e[1];fsCreateDataFile(eSpeakDataDir,n,a)}),configDataLoaded=!0;var n=e.voice;"object"==typeof n&&"string"==typeof n.voice_id&&"string"==typeof n.dict_id&&"string"==typeof n.dict&&"string"==typeof n.voice&&setVoiceData(n),executeQueuedCalls()}function setVoiceData(e){var n,a,t,o;if(!voicesLoaded[e.voice_id]){if(e.dict_id&&!eSpeak.FS.findObject(eSpeakDataDir+"/"+e.dict_id)&&fsCreateDataFile(eSpeakDataDir,e.dict_id,decodeBase64ToArray(e.dict)),n=e.voice_id.split("/"),a=eSpeakVoicesDir,1<n.length&&(a+="/"+n.slice(0,n.length-1).join("/")),t=n[n.length-1],"text"==e.voice_encoding?fsCreateDataFile(a,t,decodeStringToArray(e.voice)):fsCreateDataFile(a,t,decodeBase64ToArray(e.voice)),e.files&&Array.isArray(e.files))for(var r=0,i=e.files.length;r<i;r++)"object"==typeof(o=e.files[r])&&"string"==typeof o.path&&o.path.length&&"string"==typeof o.data&&o.data.length&&(a=1<(n=o.path.split("/")).length?eSpeakDataDir+"/"+n.slice(0,n.length-1).join("/"):eSpeakDataDir,t=n[n.length-1],"text"==o.encoding?fsCreateDataFile(a,t,decodeStringToArray(o.data)):fsCreateDataFile(a,t,decodeBase64ToArray(o.data)));voicesLoaded[e.voice_id]=!0}setDefaultVoice(e.voice_id),executeQueuedCalls()}function decodeBase64ToArray(e){function n(e){return 43==e?62:47==e?63:61==e?64:e<=57?e+4:e<=90?e-65:e-71}for(var a,t,o,r,i=[],s=0,l=e.length;s<l;)a=n(e.charCodeAt(s++)),t=n(e.charCodeAt(s++)),o=n(e.charCodeAt(s++)),r=n(e.charCodeAt(s++)),i.push(a<<2|t>>4),64!=o&&i.push((15&t)<<4|o>>2),64!=r&&i.push((3&o)<<6|r);return i}function encode64(e){for(var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a="",t=0,o=0,r=0,i=e.length;r<i;r++)for(t=t<<8|e[r],o+=8;6<=o;){var s=t>>o-6&63;o-=6,a+=n[s]}return 2==o?(a+=n[(3&t)<<4],a+="=="):4==o&&(a+=n[(15&t)<<2],a+="="),a}function decodeStringToArray(e){var n,a=[],t=e.length;for(n=0;n<t;n++)a.push(e.charCodeAt(n));return a}function executeQueuedCalls(){if(configDataLoaded&&defaultVoice){for(var e=0,n=speakQueue.length;e<n;e++){var a=speakQueue[e];a[3].multipart?speakMultipart(a[0],a[1],a[2],a[3]):speak(a[0],a[1],a[2],a[3])}speakQueue.length=0}}function resetQueue(){speakQueue.length=0}function speak(e,n,a,t){if("object"!=typeof n&&(n={}),!canPlay&&!n.rawdata)return console.warn("meSpeak: Can't play; No audio support."),0;if(t&&isValidJobId(t)||(t=getJobId()),!configDataLoaded||!defaultVoice)return console.warn((configDataLoaded?"No voice module loaded":"No config-data loaded")+", deferring call."),n.rawdata?null:(speakQueue.push([e,n,a,t]),t.number);n&&n.voice&&!voicesLoaded[n.voice]&&console.warn("Voice "+n.voice+" not available. Using default voice: "+defaultVoice);var o=n.voice?String(n.voice):n.v?String(n.v):defaultVoice;0==o.indexOf("mb/mb-")&&(o=o.substring(3)),n.variant&&(o+="+"+String(n.variant).replace(/\+/g,""));var r=["-w","wav.wav","-a",void 0!==n.amplitude?String(n.amplitude):void 0!==n.a?String(n.a):"100","-g",void 0!==n.wordgap?String(n.wordgap):void 0!==n.g?String(n.g):"0","-p",void 0!==n.pitch?String(n.pitch):void 0!==n.p?String(n.p):"50","-s",void 0!==n.speed?String(n.speed):void 0!==n.s?String(n.s):"175","-b",n.utf16?"4":void 0!==n.b?String(n.b):"1","-v",o],i=n.linebreak||n.l;i&&r.push("-l",String(i)),(i=n.capitals||n.k)&&r.push("-k",String(i)),(i=n.nostop||n.z)&&r.push("-z"),void 0!==n.punct&&("string"==typeof n.punct?n.punct.length?r.push('--punct="'+String(n.punct).replace(/([\\"'])/g,"\\$1")+'"'):r.push("--punct"):n.punct&&r.push("--punct")),(i=n.ssml||n.m||n.markup)&&r.push("-m"),r.push("--path="+eSpeakDir,String(e)),n.log&&self.console&&console.log("executing espeak "+r.join(" ")),eSpeak.Module.arguments=r,"function"!=typeof a&&(a=void 0),a||"function"!=typeof n.callback||(a=n.callback),fsErrorDetected=!1,eSpeak.run(),fsErrorDetected&&(fsErrorDetected=!1,eSpeak.Module.arguments=r,eSpeak.run());var s=eSpeak.FS.root.contents["wav.wav"].contents,l=unsignedStream(s);return s.length=0,r=null,n.rawdata?exportStream(l,n.rawdata):playSound(l,n.volume,a,t)}function exportStream(e,n){switch(String(n).toLowerCase()){case"array":return e;case"base64":return encode64(e);case"buffer":return new Buffer(e);case"data-url":case"data-uri":case"dataurl":case"datauri":case"mime":return"data:audio/x-wav;base64,"+encode64(e);default:var a=new ArrayBuffer(e.length);return new Uint8Array(a).set(e),a}}function speakMultipart(e,n,a,t){if("object"!=typeof n&&(n={}),!canPlay&&!n.rawdata)return console.warn("meSpeak: Can't play; No audio support."),0;var o,r,i=!1;if("function"!=typeof a&&(a=void 0),a||"function"!=typeof n.callback||(a=n.callback),"[object Array]"==Object.prototype.toString.call(e)&&e.length||(console.warn("meSpeak.speakMultipart: First argument must be an array of objects."),i=!0),!i)for(var s=0,l=e.length;s<l;s++)if("object"!=typeof e[s]){console.warn("meSpeak.speakMultipart: First argument must be an array of objects (part #"+s+")."),i=!0;break}if(i)return n.rawdata?null:(a&&a(!1),0);if(t&&isValidJobId(t)||(t=getJobId()),!configDataLoaded||!defaultVoice)return console.warn((configDataLoaded?"No voice module loaded":"No config-data loaded")+", deferring call."),n.rawdata?null:(t.multipart=!0,speakQueue.push([e,n,a,t]),t.number);for(s=0,l=e.length;s<l;s++){var u,d=e[s],c={};for(u in n)c[u]=n[u];for(u in d)c[u]=d[u];c.rawdata="array",c.callback=void 0;var f=meSpeak.speak(d.text,c);if(!f)return n.rawdata?null:(a&&a(!1),0);0==s?r=readBytes(o=f,40,4):(r+=readBytes(f,40,4),o=o.concat(f.slice(44))),f=null}return writeBytes(o,4,4,r),writeBytes(o,40,4,r),n.rawdata?exportStream(o,n.rawdata):playSound(o,n.volume,a,t)}function writeBytes(e,n,a,t){for(;a;)e[n++]=255&t,t>>=8,a--}function readBytes(e,n,a){for(var t=0,o=0;a;)t|=e[n++]<<o,o+=8,a--;return t}function unsignedStream(e){var n,a,t=e.length,o=new Array(t);for(n=0;n<t;n++)a=e[n],o[n]=0<=a?a:256+a;return o}function getJobId(){for(var e,n;!e||audioPool[n]||webSoundPool[n];)n=(e=Math.floor(Math.random()*Math.pow(2,32))).toString(16);return{number:e,string:n}}function isValidJobId(e){return!("[object Object]"!==Object.prototype.toString.call(e)||"[object Number]"!==Object.prototype.toString.call(e.number)||"[object String]"!==Object.prototype.toString.call(e.string)||!e.number||e.string!==e.number.toString(16))}function playSound(e,n,a,t){a&&"function"!=typeof a&&(a=void 0),t&&isValidJobId(t)||(t=getJobId());var o=Object.prototype.toString.call(e);if("[object Array]"!=o&&"[object ArrayBuffer]"!=o&&"[object String]"!=o)return console.warn("meSpeak: Can't play, not an Array, or ArrayBuffer, or base64-String: "+o),a&&a(!1),0;if(void 0!==n&&(n=parseFloat(n),(isNaN(n)||n<0||1<n)&&(n=void 0)),AudioAPI){if("[object String]"==o){if(0==e.indexOf("data:audio/x-wav;base64,",0)&&(e=e.substring(24)),(e=e.replace(/=+$/,"")).match(/[^A-Za-z0-9\+\/]/))return console.warn("meSpeak: Can't play, not a proper base64-String."),a&&a(!1),0;if(!(e=decodeBase64ToArray(e)).length)return console.warn("meSpeak: Can't play, empty sound data."),a&&a(!1),0;o="[object Array]"}if("[object Array]"==o){var r=new ArrayBuffer(e.length);new Uint8Array(r).set(e)}else r=e;return playWebSound(r,n,a,t)}if(canPlay){var i=!1;if("[object String]"==o){if(e.indexOf("data:audio/x-wav;base64,",0)<0){if(e.match(/[^A-Za-z0-9\+\/]/))return console.warn("meSpeak: Can't play, not a proper base64-String."),a&&a(!1),0;e="data:audio/x-wav;base64,"+e}i=!0}else"[object ArrayBuffer]"==o&&(e=new Uint8Array(e));return new AudioPlayback(e,n,i,a,t).started?t.number:0}return console.warn("meSpeak: Can't play; No audio support."),a&&a(!1),0}function stopSound(){var e,n,a,t,o,r,i,s=0;if(0<arguments.length){for(n=0,o=arguments.length;n<o;n++)if((i=parseInt(arguments[n]))&&!isNaN(i))if(e=i.toString(16),audioPool[e])audioPool[e].stop(),s++;else if(webSoundPool[e])stopWebSound(webSoundPool[e]),s++;else for(a=0,t=speakQueue.length;a<t;a++)if((r=speakQueue[n])[3].string===e){unloading||"function"!=typeof r[2]||r[2](!1),speakQueue.splice(a,1),s++;break}}else{for(e in audioPool)audioPool[e].stop(),s++;for(e in webSoundPool)stopWebSound(webSoundPool[e]),s++;for(n=0,o=speakQueue.length;n<o;n++)r=speakQueue[n],unloading||"function"!=typeof r[2]||r[2](!1),s++;speakQueue.length=0}return s}function setVolume(e){var n,a,t,o,r;if(r=parseFloat(e),!isNaN(r)&&0<=r&&r<=1&&r!=playbackVolume)if(1==arguments.length&&(playbackVolume=r),AudioAPI)if(1<arguments.length)for(a=0,t=arguments.length;a<t;a++)(o=parseInt(arguments[a]))&&!isNaN(o)&&(n=o.toString(16),webSoundPool[n]&&setWebSoundVolume(webSoundPool[n],r));else masterGain&&(masterGain.gain.value=playbackVolume);else if(canPlay)if(1<arguments.length)for(a=0,t=arguments.length;a<t;a++)(o=parseInt(arguments[a]))&&!isNaN(o)&&(n=o.toString(16),audioPool[n]&&audioPool[n].setVolume(r));else for(n in audioPool)audioPool[n].adjustVolume();return e}function getVolume(){if(!arguments.length)return playbackVolume;var e=parseInt(arguments[0]);if(e&&!isNaN(e)){var n=e.toString(16);if(webSoundPool[n])return webSoundPool[n].relVolume;if(audioPool[n])return audioPool[n].relVolume}}function resolveAudioApi(){if("undefined"!=typeof window&&self.AudioContext)return AudioAPI=self.AudioContext,void(canPlay=!0);if("undefined"!=typeof window)for(var e=["webkit","moz","o","ms"],n=0;n<e.length;n++){var a=window[e[n]+"AudioContext"];if(a)return AudioAPI=a,void(canPlay=!0)}if(!AudioAPI){if("undefined"==typeof window)return canPlay=!0,void console.warn("meSpeak: Not in browser Only able to do raw");var t=document.createElement("audio");t&&t.canPlayType&&(t.canPlayType("audio/wav")||t.canPlayType("audio/x-wav"))?canPlay=!0:(canPlay=!1,console.warn('meSpeak: Muted. No support for HTMLAudioElement with MIME "audio/x-wav" dected.'))}}function canPlaybackWav(){return canPlay}function AudioPlayback(e,n,a,t,o){this.relVolume=n,this.audio=null,this.id=o.string,this.callback="function"==typeof t?t:void 0,this.playing=!1,this.started=!1,this.play(e,a)}function playWebSound(e,n,t,o){try{var r,i,a;return audioContext||(audioContext=new AudioAPI),masterGain||((masterGain=audioContext.createGain?audioContext.createGain():audioContext.createGainNode()).connect(audioContext.destination),masterGain.gain.value=playbackVolume),r=audioContext.createBufferSource(),(void 0===(a=parseFloat(n))||isNaN(a)||a<0||1<a)&&(a=1),(i=audioContext.createGain?audioContext.createGain():audioContext.createGainNode()).connect(masterGain),i.gain.value=a,r.connect(i),audioContext.decodeAudioData(e,function(e){var n=function(){webSoundEndHandler(r,i,t,!0,o.string)};if(isChrome||void 0===r.onended){var a=e.duration;setTimeout(n,a?Math.ceil(1e3*a):10)}else r.onended=n;r.buffer=e,32<=chromeVersion&&r.start&&r.start(0)},function(e){return console.log("meSpeak: Web Audio Decoding Error: "+("object"==typeof e?e.message:e)),r&&r.disconnect(),i&&i.disconnect(),webSoundPool[o.string]&&delete webSoundPool[o.string],unloading||"function"!=typeof t||t(!1),0}),webSoundPool[o.string]={source:r,gainNode:i,callback:t,id:o.string,relVolume:a},chromeVersion<32&&(r.start?r.start(0):r.noteOn(0)),o.number}catch(e){return console.warn("meSpeak: Web Audio Exception: "+e.message),webSoundEndHandler(r,i,t,!1,o.string),0}}function webSoundEndHandler(e,n,a,t,o){unloading||"function"!=typeof a||a(t);var r=function(){e&&(void 0!==e.onended&&(e.onended=void 0),e.disconnect()),n&&n.disconnect(),o&&webSoundPool[o]&&delete webSoundPool[o]};t?setTimeout(r,500):r()}function stopWebSound(e){try{e.source.stop?e.source.stop(0):e.sourcesource.noteOff(0)}catch(e){}webSoundEndHandler(e.source,e.gainNode,e.callback,!1,e.id)}function setWebSoundVolume(e,n){e.gainNode.gain.value=n,e.relVolume=n}function setDefaultVoice(e){e&&voicesLoaded[e]&&(defaultVoice=e)}function getDefaultVoice(){return defaultVoice}function loadVoice(e,n){"string"!=typeof e?(setVoiceData(e),n&&n(!1,e.voice_id)):e&&new HttpRequest(e,voiceRequestCallback,n)}function loadConfig(e){"object"==typeof e?setConfigData(e):e&&new HttpRequest(e,configDataRequestCallback,null)}function isVoiceLoaded(e){return!!voicesLoaded[e]}function isConfigLoaded(){return!!configDataLoaded}function voiceRequestCallback(){var e=this.request;if(4==e.readyState){if(this.localmode||200==e.status){var n=JSON.parse(e.responseText);"object"==typeof n&&"string"==typeof n.voice_id&&"string"==typeof n.voice&&(!n.dict_id&&!n.dict_id||"string"==typeof n.dict_id&&"string"==typeof n.dict||!n.files||"object"==typeof n.files&&Array.isArray(n.files))?(setVoiceData(n),"function"==typeof this.userCallback&&this.userCallback(!0,n.voice_id)):(console.warn("Failed to load voice from "+this.url+": Not a voice module."),"function"==typeof this.userCallback&&this.userCallback(!1,"data error"))}else console.warn("Failed to load voice from "+this.url+": Received status "+e.status+"."),"function"==typeof this.userCallback&&this.userCallback(!1,"file error");this.request=this.handler=this.userCallback=null}}function configDataRequestCallback(){var e=this.request;if(4==e.readyState){if(this.localmode||200==e.status){var n=JSON.parse(e.responseText);"object"==typeof n&&"string"==typeof n.config&&"string"==typeof n.phontab&&"string"==typeof n.phonindex&&"string"==typeof n.phondata&&"string"==typeof n.intonations?setConfigData(n):console.warn("Failed to load config-data from "+this.url+": No valid data.")}else console.warn("Failed to load config-data from "+this.url+": Received status "+e.status+".");this.request=this.handler=this.userCallback=null}}function unloadHandler(e){unloading=!0,stopSound(),audioPool={},webSoundPool={}}eSpeak&&eSpeak.FS&&setUpVFS(),resolveAudioApi(),AudioPlayback.prototype={play:function(e,n){try{(audioPool[this.id]=this).audio=document.createElement("audio"),this.adjustVolume();var a=this;this.audio.addEventListener("ended",function(){a.remove()},!1),this.audio.addEventListener("canplaythrough",function(){a.audio.play(),a.playing=!0},!1),this.audio.src=n?e:"data:audio/x-wav;base64,"+encode64(e),this.audio.load(),this.started=!0}catch(e){console.warn("meSpeak: HTMLAudioElement Exception: "+e.message),this.started=!1,this.remove()}},adjustVolume:function(){this.audio.volume=void 0!==this.relVolume?this.relVolume*playbackVolume:playbackVolume},setVolume:function(e){this.relVolume=e,this.adjustVolume()},remove:function(e){if(this.id&&delete audioPool[this.id],this.callback){var n=this.callback;this.callback=void 0,unloading||n(!e)}},stop:function(){try{this.playing&&this.audio.pause()}catch(e){}this.remove(!0)}},HttpRequest="undefined"==typeof window?function(e,n,a){var t=new Error("meSpeak: URLs not supported in Node.js");if(!a)throw t;a(t,null)}:function(n,e,a){var t=this.request=new XMLHttpRequest;this.handler=e,this.url=n,this.localmode=Boolean(0==window.location.href.search(/^file:/i)),this.userCallback=a;var o=this;try{t.open("GET",n),t.onreadystatechange=function(){o.handler()},t.send("")}catch(e){window.console&&console.warn("Failed to load resource from "+n+": Network error."),"function"==typeof a&&a(!1,"network error"),this.request=this.handler=this.userCallback=null}},"undefined"!=typeof window&&window.addEventListener("unload",unloadHandler,!1),module.exports={speak:speak,speakMultipart:speakMultipart,loadConfig:loadConfig,loadVoice:loadVoice,setDefaultVoice:setDefaultVoice,getDefaultVoice:getDefaultVoice,setVolume:setVolume,getVolume:getVolume,play:playSound,isConfigLoaded:isConfigLoaded,isVoiceLoaded:isVoiceLoaded,resetQueue:resetQueue,canPlay:canPlaybackWav,stop:stopSound};
//# sourceMappingURL=/sm/d6f3eaabc0ef9bcc6ace11c63f10b09ca4910597841bb9c1e0afafe69297c60c.map